<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Reporte Mensual</title>
    <style>
        body {
            font-family: Arial;
            background-color: #240018;
            color: white;
            margin: 0;
            padding: 0;
        }

        h1 {
            background-color: #4b0030;
            padding: 20px;
            text-align: center;
        }

        h2 {
            color: #ffb6c1;
            text-align: center;
            margin-top: 30px;
        }

        table {
            width: 90%;
            margin: 20px auto;
            border-collapse: collapse;
            background-color: white;
            color: black;
            border-radius: 10px;
            overflow: hidden;
        }

        th, td {
            padding: 10px;
            border-bottom: 1px solid #ddd;
            text-align: center;
        }

        th {
            background-color: #4b0030;
            color: white;
        }

        .btn {
            display: block;
            background-color: #5A002F;
            padding: 12px;
            width: 260px;
            margin: 20px auto;
            text-align: center;
            border-radius: 10px;
            color: white;
            text-decoration: none;
            cursor: pointer;
        }

        .btn:hover {
            background-color: #7A0040;
        }

        .resumen {
            width: 90%;
            background: white;
            color: black;
            margin: 20px auto;
            padding: 20px;
            border-radius: 10px;
        }
    </style>
</head>
<body>

<h1>ðŸ“Š Reporte Mensual del Sistema</h1>

<a class="btn" href="Administrador.html">Regresar</a>

<!-- PRÃ‰STAMOS -->
<h2>ðŸ“š PrÃ©stamos del Mes</h2>
<table>
    <thead>
        <tr>
            <th>Usuario</th>
            <th>Libro</th>
            <th>Autor</th>
            <th>Fecha</th>
            <th>Fecha LÃ­mite</th>
        </tr>
    </thead>
    <tbody id="tablaPrestamos"></tbody>
</table>

<!-- MULTAS -->
<h2>ðŸ’¸ Multas del Mes</h2>
<table>
    <thead>
        <tr>
            <th>Usuario</th>
            <th>Libro</th>
            <th>Monto</th>
            <th>Fecha</th>
        </tr>
    </thead>
    <tbody id="tablaMultas"></tbody>
</table>

<!-- EXISTENCIAS -->
<h2>ðŸ“¦ Existencias Finales del Mes</h2>
<table>
    <thead>
        <tr>
            <th>TÃ­tulo</th>
            <th>Autor</th>
            <th>Existencias</th>
        </tr>
    </thead>
    <tbody id="tablaExistencias"></tbody>
</table>

<!-- RESUMEN -->
<div class="resumen" id="resumenFinal"></div>

<script>
function generarReporte() {
    const mesActual = new Date().toISOString().slice(0, 7);

    const prestamos = JSON.parse(localStorage.getItem("prestamosAdmin")) || [];
    const multas = JSON.parse(localStorage.getItem("multasAdmin")) || [];
    const libros = JSON.parse(localStorage.getItem("libros")) || [];

    const tablaPrestamos = document.getElementById("tablaPrestamos");
    const tablaMultas = document.getElementById("tablaMultas");
    const tablaExistencias = document.getElementById("tablaExistencias");

    tablaPrestamos.innerHTML = "";
    tablaMultas.innerHTML = "";
    tablaExistencias.innerHTML = "";

    let totalMultas = 0;

    // âœ… PRÃ‰STAMOS DEL MES
    prestamos.filter(p => p.fechaPrestamo.startsWith(mesActual)).forEach(p => {
        tablaPrestamos.innerHTML += `
            <tr>
                <td>${p.usuario}</td>
                <td>${p.titulo}</td>
                <td>${p.autor}</td>
                <td>${p.fechaPrestamo}</td>
                <td>${p.fechaLimite}</td>
            </tr>
        `;
    });

    // âœ… MULTAS DEL MES
    multas.filter(m => m.fecha.startsWith(mesActual)).forEach(m => {
        totalMultas += parseFloat(m.monto);
        tablaMultas.innerHTML += `
            <tr>
                <td>${m.usuario}</td>
                <td>${m.titulo}</td>
                <td>$${m.monto}</td>
                <td>${m.fecha}</td>
            </tr>
        `;
    });

    // âœ… EXISTENCIAS FINALES
    libros.forEach(l => {
        tablaExistencias.innerHTML += `
            <tr>
                <td>${l.nombre}</td>
                <td>${l.autor}</td>
                <td>${l.existencias}</td>
            </tr>
        `;
    });

    // âœ… RESUMEN FINAL
    document.getElementById("resumenFinal").innerHTML = `
        <h2>ðŸ“‘ Resumen del Mes</h2>
        <p><b>Total de PrÃ©stamos:</b> ${prestamos.length}</p>
        <p><b>Total de Multas:</b> $${totalMultas.toFixed(2)}</p>
        <p><b>Total de Libros en Existencia:</b> ${libros.length}</p>
    `;
}

generarReporte();
</script>

</body>
</html>
